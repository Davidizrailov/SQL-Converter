FILE PERSFILE
  EMPNO    1  5 A
  NAME     6 25 A
  DEPT    26 30 A
  SALARY  31 36 N 2
  DOJ     37 44 D

FILE DEPTFILE
  DEPTNO   1  4 A
  DEPTNAME 5 30 A

JOB INPUT (PERSFILE)
  DEFINE DOJ_YEAR  5 N = YEAR(DOJ)
  DEFINE HIGH_SAL  1 N
  DEFINE LOW_SAL   1 N
  DEFINE AVG_SAL   1 N
  IF DEPT = 'FIN' OR DEPT = 'HR'
    HIGH_SAL = 1
  END-IF
  IF DEPT = 'IT'
    LOW_SAL = 1
  END-IF
  TOTAL SALARY
  CONTROL DEPT
  PRINT REPORT1

REPORT REPORT1
  LINESIZE 80
  TITLE 01 'EMPLOYEE REPORT'
  TITLE 02 'DEPARTMENTAL DETAILS'
  COLUMN EMPNO     5 'EMP NO'
  COLUMN NAME     15 'EMPLOYEE NAME'
  COLUMN DEPT     45 'DEPARTMENT'
  COLUMN SALARY   60 'SALARY'
  COLUMN DOJ      70 'DATE OF JOINING'
  LINE   EMPNO NAME DEPT SALARY DOJ

JOB INPUT (PERSFILE DEPTFILE)
  FILETYPE IS FILE
  JOIN
    WITH DEPTFILE
    MATCH ON DEPT = DEPTNO
  END-JOIN
  PRINT REPORT2

REPORT REPORT2
  LINESIZE 80
  TITLE 01 'DEPARTMENT EMPLOYEE REPORT'
  TITLE 02 'EMPLOYEES BY DEPARTMENT'
  COLUMN DEPTNO   5 'DEPT NO'
  COLUMN DEPTNAME 15 'DEPARTMENT NAME'
  COLUMN EMPNO    45 'EMP NO'
  COLUMN NAME     55 'EMPLOYEE NAME'
  COLUMN SALARY   70 'SALARY'
  LINE   DEPTNO DEPTNAME EMPNO NAME SALARY

  IF HIGH_SAL
    PRINT REPORT_HIGH
  END-IF
  IF LOW_SAL
    PRINT REPORT_LOW
  END-IF

REPORT REPORT_HIGH
  LINESIZE 80
  TITLE 01 'HIGH SALARY EMPLOYEES REPORT'
  COLUMN EMPNO   5 'EMP NO'
  COLUMN NAME   15 'EMPLOYEE NAME'
  COLUMN DEPT   45 'DEPARTMENT'
  COLUMN SALARY 60 'SALARY'
  LINE   EMPNO NAME DEPT SALARY

REPORT REPORT_LOW
  LINESIZE 80
  TITLE 01 'LOW SALARY EMPLOYEES REPORT'
  COLUMN EMPNO   5 'EMP NO'
  COLUMN NAME   15 'EMPLOYEE NAME'
  COLUMN DEPT   45 'DEPARTMENT'
  COLUMN SALARY 60 'SALARY'
  LINE   EMPNO NAME DEPT SALARY